"use strict";(self.webpackChunksf_documentation=self.webpackChunksf_documentation||[]).push([[7023],{3905:function(a,e,t){t.d(e,{Zo:function(){return l},kt:function(){return k}});var n=t(7294);function m(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function r(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,n)}return t}function s(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?r(Object(t),!0).forEach((function(e){m(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function o(a,e){if(null==a)return{};var t,n,m=function(a,e){if(null==a)return{};var t,n,m={},r=Object.keys(a);for(n=0;n<r.length;n++)t=r[n],e.indexOf(t)>=0||(m[t]=a[t]);return m}(a,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);for(n=0;n<r.length;n++)t=r[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(m[t]=a[t])}return m}var p=n.createContext({}),i=function(a){var e=n.useContext(p),t=e;return a&&(t="function"==typeof a?a(e):s(s({},e),a)),t},l=function(a){var e=i(a.components);return n.createElement(p.Provider,{value:e},a.children)},c={inlineCode:"code",wrapper:function(a){var e=a.children;return n.createElement(n.Fragment,{},e)}},N=n.forwardRef((function(a,e){var t=a.components,m=a.mdxType,r=a.originalType,p=a.parentName,l=o(a,["components","mdxType","originalType","parentName"]),N=i(t),k=m,d=N["".concat(p,".").concat(k)]||N[k]||c[k]||r;return t?n.createElement(d,s(s({ref:e},l),{},{components:t})):n.createElement(d,s({ref:e},l))}));function k(a,e){var t=arguments,m=e&&e.mdxType;if("string"==typeof a||m){var r=t.length,s=new Array(r);s[0]=N;var o={};for(var p in e)hasOwnProperty.call(e,p)&&(o[p]=e[p]);o.originalType=a,o.mdxType="string"==typeof a?a:m,s[1]=o;for(var i=2;i<r;i++)s[i]=t[i];return n.createElement.apply(null,s)}return n.createElement.apply(null,t)}N.displayName="MDXCreateElement"},8394:function(a,e,t){t.r(e),t.d(e,{assets:function(){return l},contentTitle:function(){return p},default:function(){return k},frontMatter:function(){return o},metadata:function(){return i},toc:function(){return c}});var n=t(3117),m=t(102),r=(t(7294),t(3905)),s=["components"],o={},p="Java tracing",i={unversionedId:"Tracing/java",id:"Tracing/java",title:"Java tracing",description:"sfTrace Java Agent automatically instruments various APIs, frameworks and application servers. Currently sfTrace supports the following:",source:"@site/docs/Tracing/java.md",sourceDirName:"Tracing",slug:"/Tracing/java",permalink:"/docs/Tracing/java",editUrl:"https://github.com/ram-dot-kumar/SFwebsite.git/docs/Tracing/java.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Tracing",permalink:"/docs/category/tracing"},next:{title:"Python tracing",permalink:"/docs/Tracing/python"}},l={},c=[{value:"Available Platforms",id:"available-platforms",level:4},{value:"Instances",id:"instances",level:2},{value:"Command Line",id:"command-line",level:3},{value:"Additional features available for Spring Boot Applications",id:"additional-features-available-for-spring-boot-applications",level:4},{value:"Normalizing Transaction URLs",id:"normalizing-transaction-urls",level:4},{value:"Example of running java application via command line using these parameters",id:"example-of-running-java-application-via-command-line-using-these-parameters",level:4},{value:"Enable Trace to Log feature",id:"enable-trace-to-log-feature",level:4},{value:"Apache Tomcat",id:"apache-tomcat",level:3},{value:"Additional features available for Spring Boot Applications",id:"additional-features-available-for-spring-boot-applications-1",level:4},{value:"Normalizing Transaction URLs",id:"normalizing-transaction-urls-1",level:4},{value:"Example of running java application via command line using these parameters",id:"example-of-running-java-application-via-command-line-using-these-parameters-1",level:4},{value:"Enable Trace to Log feature",id:"enable-trace-to-log-feature-1",level:4},{value:"JBOSS EAP",id:"jboss-eap",level:3},{value:"Standalone Mode",id:"standalone-mode",level:4},{value:"Domain Mode",id:"domain-mode",level:4},{value:"Additional features available for Spring Boot Applications",id:"additional-features-available-for-spring-boot-applications-2",level:4},{value:"Normalizing Transaction URLs",id:"normalizing-transaction-urls-2",level:4},{value:"Example of running java application via command line using these parameters",id:"example-of-running-java-application-via-command-line-using-these-parameters-2",level:4},{value:"Docker",id:"docker",level:2},{value:"Kubernetes",id:"kubernetes",level:2},{value:"Example of Manifest yaml",id:"example-of-manifest-yaml",level:3},{value:"Example of a Helm chart",id:"example-of-a-helm-chart",level:3},{value:"ECS",id:"ecs",level:2},{value:"Create the Task definition",id:"create-the-task-definition",level:3},{value:"Create the Cluster",id:"create-the-cluster",level:3},{value:"Create the Service",id:"create-the-service",level:3}],N={toc:c};function k(a){var e=a.components,t=(0,m.Z)(a,s);return(0,r.kt)("wrapper",(0,n.Z)({},N,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"java-tracing"},"Java tracing"),(0,r.kt)("p",null,"sfTrace Java Agent automatically instruments various APIs, frameworks and application servers. Currently sfTrace supports the following:  "),(0,r.kt)("div",{class:"blue_textbox"},(0,r.kt)("b",null,"Supported Java versions"),(0,r.kt)("p",null,"Oracle JDK: 7u60+, 8u40+, 9, 10, 11 ",(0,r.kt)("br",null),"Open JDK: 7u60+, 8u40+, 9, 10, 11 "),(0,r.kt)("b",null,"Supported Web Frameworks"),(0,r.kt)("p",null,"Spring Web MVC 4.x, 5.x ",(0,r.kt)("br",null),"Spring Boot 1.5+, 2.x supports embedded Tomcat ",(0,r.kt)("br",null),"JAX-RS 2.x  ",(0,r.kt)("br",null),"JAX-WS  ",(0,r.kt)("br",null)),(0,r.kt)("b",null,"Supported Application Servers"),(0,r.kt)("p",null,"Tomcat 7.x, 8.5.x, 9.x ",(0,r.kt)("br",null),"Wildfly 8-16 ",(0,r.kt)("br",null),"JBoss EAP 6.4, 7.0, 7.1, 7.2")),(0,r.kt)("h4",{id:"available-platforms"},"Available Platforms"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"java#instances"},(0,r.kt)("strong",{parentName:"a"},"Instances"))),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"java#docker"},(0,r.kt)("strong",{parentName:"a"},"Docker"))),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"java#kubernetes"},(0,r.kt)("strong",{parentName:"a"},"Kubernetes"))),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"java#ecs"},(0,r.kt)("strong",{parentName:"a"},"ECS"))),(0,r.kt)("h2",{id:"instances"},"Instances"),(0,r.kt)("p",null,"Install ",(0,r.kt)("a",{parentName:"p",href:"/docs/Quick_Start/getting_started#sfagent"},"sfAgent")," which automatically installs sfTrace agent as well."),(0,r.kt)("p",null,"Link the application with sfTrace Java Agent"),(0,r.kt)("h3",{id:"command-line"},"Command Line"),(0,r.kt)("p",null,"Use the following arguments while starting your application using java ",(0,r.kt)("inlineCode",{parentName:"p"},"\u2013jar"),"\u202fcommand, in IDE, Maven or Gradle script: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"java -javaagent:/opt/sfagent/sftrace/java/sftrace-java-agent.jar -Dsftrace.service_name=<my-service> -jar <application jar> \n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If\u202f",(0,r.kt)("inlineCode",{parentName:"p"},"service_name"),"\u202fis not provided, an auto discovered service name will be added. ",(0,r.kt)("inlineCode",{parentName:"p"},"Service_name")," is used to identify and filter the traces related to an application and should be named appropriately to distinctly identify it. Service name must only contain characters from the ASCII alphabet, numbers, dashes, underscores and spaces."))),(0,r.kt)("h4",{id:"additional-features-available-for-spring-boot-applications"},"Additional features available for Spring Boot Applications"),(0,r.kt)("p",null,"By default, transaction names of unsupported Servlet API-based frameworks are in the form of ",(0,r.kt)("span",{parentName:"p",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"u"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"k"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"w"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"u"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,r.kt)("mi",{parentName:"mrow"},"T"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mi",{parentName:"mrow"},"y"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"p"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"c"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mtext",{parentName:"mrow"},"\u202f")),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"method unknown route. To modify this and to report the transactions names in the form of\u202f")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"u"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"nkn"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"ro"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"u"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord"},"."),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"hi"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"ore"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"tt"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"c"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"nam"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"es"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"in"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord"},"\u202f"))))),"method $path, use the following in javaagent configuration. This option is applicable only for spring-boot based applications."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"-Delastic.apm.disable_instrumentations=spring-mvc  \n-Delastic.apm.use_path_as_transaction_name=true \n")),(0,r.kt)("h4",{id:"normalizing-transaction-urls"},"Normalizing Transaction URLs"),(0,r.kt)("p",null,"If your URLs contain path parameters like ",(0,r.kt)("inlineCode",{parentName:"p"},"/user/$userId"),", it can lead to an explosion of transaction types. This can be avoided by using URL groups.\nFor example, if the application supports urls like: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/owners, /owners/<owner_id>, /owners/<owner_id>/edit, /owners/<owner_id>/pets, \n")),(0,r.kt)("p",null,"then url groups would be configured as: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"url_groups=/owners/*,/owner/*/edit,/owners/*/pets \n")),(0,r.kt)("h4",{id:"example-of-running-java-application-via-command-line-using-these-parameters"},"Example of running java application via command line using these parameters"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"java -javaagent:/opt/sfagent/sftrace/java/sftrace-java-agent.jar \n\n-Dsftrace.service_name=my-service \n-Delastic.apm.disable_instrumentations=spring-mvc \n-Delastic.apm.use_path_as_transaction_name=true \n-Delastic.apm.url_groups=/owners/*,/owner/*/edit,/owners/*/pets -jar <application jar> \n")),(0,r.kt)("h4",{id:"enable-trace-to-log-feature"},"Enable Trace to Log feature"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Add below system property to enable the feature:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'-Delastic.apm.global_labels="_tag_redact_body=true"\n')),(0,r.kt)("p",{parentName:"li"},"We also provide custom document type and destination index configs for this feature.(Optional)"),(0,r.kt)("p",{parentName:"li"},'a. Add below label to provide custom documentType (Default:"log"):'),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'-Delastic.apm.global_labels="_tag_redact_body=true,_tag_IndexType=metric" // Applicable values(log, metric)\n')),(0,r.kt)("p",{parentName:"li"},'b. Add below label to provide custom documentType (Default:"user-input"):'),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'-Delastic.apm.global_labels="_tag_redact_body=true,_tag_documentType=<document-type>"\n')),(0,r.kt)("b",null,"Note "),": ",(0,r.kt)("i",null,"-Delastic.apm.capture_body=all properties needs to added when enabling trace to log feature"),(0,r.kt)("p",{parentName:"li"},"Run Command:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'java -javaagent:/opt/sfagent/sftrace/java/sftrace-java-agent.jar \n-Dsftrace.service_name=spring-service \n-Delastic.apm.use_path_as_transaction_name=true\n-Delastic.apm.capture_body=all \n-Delastic.apm.global_labels="_tag_redact_body=true,_tag_IndexType=<index_type>,_tag_documentType=<document_type>"\n-Delastic.apm.metrics_interval=0s -jar target/spring-petclinic-2.1.0.BUILD-SNAPSHOT.jar\n')))),(0,r.kt)("h3",{id:"apache-tomcat"},"Apache Tomcat"),(0,r.kt)("p",null,"Add the agent configuration in setenv.sh. If this file is not present,  create the file in below folder"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"<tomcat installation path>/bin\n")),(0,r.kt)("p",null,"Refer to\u202f",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snappyflow/website-artefacts/blob/master/sfTracing/java/tomcat_setenv.sh"},"tomcat_setenv.sh"),"\u202f\u202ffor tracing specific configuration that needs to be copied to setenv.sh file.\nMake the file executable using ",(0,r.kt)("inlineCode",{parentName:"p"},"chmod +x bin/setenv.sh")," and start the server"),(0,r.kt)("h4",{id:"additional-features-available-for-spring-boot-applications-1"},"Additional features available for Spring Boot Applications"),(0,r.kt)("p",null,"By default, transaction names of unsupported Servlet API-based frameworks are in the form of\u202f",(0,r.kt)("span",{parentName:"p",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"u"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"k"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"w"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"u"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,r.kt)("mi",{parentName:"mrow"},"T"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mi",{parentName:"mrow"},"y"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"p"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"c"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mtext",{parentName:"mrow"},"\u202f")),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"method unknown route. To modify this and to report the transactions names in the form of\u202f")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"u"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"nkn"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"ro"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"u"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord"},"."),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"hi"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"ore"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"tt"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"c"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"nam"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"es"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"in"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord"},"\u202f"))))),"method $path, use the following in javaagent configuration. This option is applicable only for spring-boot based applications."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"-Delastic.apm.disable_instrumentations=spring-mvc  \n-Delastic.apm.use_path_as_transaction_name=true \n")),(0,r.kt)("h4",{id:"normalizing-transaction-urls-1"},"Normalizing Transaction URLs"),(0,r.kt)("p",null,"If your URLs contain path parameters like /user/$userId, it can lead to an explosion of transaction types. This can be avoided by using URL groups.\nFor example, if the application supports urls like: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/owners, /owners/<owner_id>, /owners/<owner_id>/edit, /owners/<owner_id>/pets, \n")),(0,r.kt)("p",null,"then url groups would be configured as: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"url_groups=/owners/*,/owner/*/edit,/owners/*/pets \n")),(0,r.kt)("h4",{id:"example-of-running-java-application-via-command-line-using-these-parameters-1"},"Example of running java application via command line using these parameters"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"java -javaagent:/opt/sfagent/sftrace/java/sftrace-java-agent.jar \n\n-Dsftrace.service_name=my-service \n-Delastic.apm.disable_instrumentations=spring-mvc \n-Delastic.apm.use_path_as_transaction_name=true \n-Delastic.apm.url_groups=/owners/*,/owner/*/edit,/owners/*/pets -jar <application jar> \n")),(0,r.kt)("h4",{id:"enable-trace-to-log-feature-1"},"Enable Trace to Log feature"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Add below system property to enable the feature:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'-Delastic.apm.global_labels="_tag_redact_body=true"\n')),(0,r.kt)("p",{parentName:"li"},"We also provide custom document type and destination index configs for this feature.(Optional)"),(0,r.kt)("p",{parentName:"li"},'a. Add below label to provide custom documentType (Default:"log"):'),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'-Delastic.apm.global_labels="_tag_redact_body=true,_tag_IndexType=metric" // Applicable values(log, metric)\n')),(0,r.kt)("p",{parentName:"li"},'b. Add below label to provide custom documentType (Default:"user-input"):'),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'-Delastic.apm.global_labels="_tag_redact_body=true,_tag_documentType=<document-type>"\n')),(0,r.kt)("b",null,"Note "),": ",(0,r.kt)("i",null,"-Delastic.apm.capture_body=all properties needs to added when enabling trace to log feature"),(0,r.kt)("p",{parentName:"li"},"Run Command:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-java"},'java -javaagent:/opt/sfagent/sftrace/java/sftrace-java-agent.jar \n-Dsftrace.service_name=spring-service \n-Delastic.apm.use_path_as_transaction_name=true\n-Delastic.apm.capture_body=all \n-Delastic.apm.global_labels="_tag_redact_body=true,_tag_IndexType=<index_type>,_tag_documentType=<document_type>"\n-Delastic.apm.metrics_interval=0s -jar target/spring-petclinic-2.1.0.BUILD-SNAPSHOT.jar\n')))),(0,r.kt)("h3",{id:"jboss-eap"},"JBOSS EAP"),(0,r.kt)("h4",{id:"standalone-mode"},"Standalone Mode"),(0,r.kt)("p",null,"Add the agent configuration in ",(0,r.kt)("inlineCode",{parentName:"p"},"standalone.conf")," file and start the server\nRefer to\u202f",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snappyflow/website-artefacts/blob/master/sfTracing/java/JBOSS_standalone.conf"},"JBOSS_standalone.conf"),"\u202ffor tracing specific configuration. Copy from section with ",(0,r.kt)("inlineCode",{parentName:"p"},"SFTRACE-CONFIG")," in comments "),(0,r.kt)("h4",{id:"domain-mode"},"Domain Mode"),(0,r.kt)("p",null,"Add the agent configuration in ",(0,r.kt)("inlineCode",{parentName:"p"},"domain.xml")," and start the server\nRefer to\u202f",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snappyflow/website-artefacts/blob/master/sfTracing/java/JBOSS_domain.xml"},"JBOSS_domain.xml"),"\u202f for tracing specific configuration. Copy from section with ",(0,r.kt)("inlineCode",{parentName:"p"},"SFTRACE-CONFIG")," in comments\nAfter updating the configuration, restart the application. "),(0,r.kt)("h4",{id:"additional-features-available-for-spring-boot-applications-2"},"Additional features available for Spring Boot Applications"),(0,r.kt)("p",null,"By default, transaction names of unsupported Servlet API-based frameworks are in the form of\u202f",(0,r.kt)("span",{parentName:"p",className:"math math-inline"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"u"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"k"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"w"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"u"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"."),(0,r.kt)("mi",{parentName:"mrow"},"T"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mi",{parentName:"mrow"},"y"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"d"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"p"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"c"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"s"),(0,r.kt)("mi",{parentName:"mrow"},"i"),(0,r.kt)("mi",{parentName:"mrow"},"n"),(0,r.kt)("mi",{parentName:"mrow"},"t"),(0,r.kt)("mi",{parentName:"mrow"},"h"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"m"),(0,r.kt)("mi",{parentName:"mrow"},"o"),(0,r.kt)("mi",{parentName:"mrow"},"f"),(0,r.kt)("mtext",{parentName:"mrow"},"\u202f")),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"method unknown route. To modify this and to report the transactions names in the form of\u202f")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"u"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"nkn"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02691em"}},"w"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"ro"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"u"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord"},"."),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"T"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"y"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"hi"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"ore"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"tt"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"an"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"c"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"s"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"nam"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"es"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"in"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"t"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"h"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"or"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"m"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10764em"}},"f"),(0,r.kt)("span",{parentName:"span",className:"mord"},"\u202f"))))),"method $path, use the following in javaagent configuration. This option is applicable only for spring-boot based applications."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"-Delastic.apm.disable_instrumentations=spring-mvc  \n-Delastic.apm.use_path_as_transaction_name=true \n")),(0,r.kt)("h4",{id:"normalizing-transaction-urls-2"},"Normalizing Transaction URLs"),(0,r.kt)("p",null,"If your URLs contain path parameters like /user/$userId, it can lead to an explosion of transaction types. This can be avoided by using URL groups.\nFor example, if the application supports urls like: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"/owners, /owners/<owner_id>, /owners/<owner_id>/edit, /owners/<owner_id>/pets, \n")),(0,r.kt)("p",null,"then url groups would be configured as: "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"url_groups=/owners/*,/owner/*/edit,/owners/*/pets \n")),(0,r.kt)("h4",{id:"example-of-running-java-application-via-command-line-using-these-parameters-2"},"Example of running java application via command line using these parameters"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"java -javaagent:/opt/sfagent/sftrace/java/sftrace-java-agent.jar \n\n-Dsftrace.service_name=my-service \n-Delastic.apm.disable_instrumentations=spring-mvc \n-Delastic.apm.use_path_as_transaction_name=true \n-Delastic.apm.url_groups=/owners/*,/owner/*/edit,/owners/*/pets -jar <application jar> \n")),(0,r.kt)("h2",{id:"docker"},"Docker"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Refer to\u202f",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snappyflow/website-artefacts/blob/master/sfTracing/java/java_Dockerfile"},"java_Dockerfile"),". Look at sections with ",(0,r.kt)("inlineCode",{parentName:"p"},"SFTRACE-CONFIG")," description. ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Installation steps are provided. Copy the trace agent to the container and start the container by attaching the agent to the application. ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Additionally, user has to add SnappyFlow configurations for ",(0,r.kt)("inlineCode",{parentName:"p"},"profile_key"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"projectName"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"appName")," to the docker file ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Once updated, build and start the container."))),(0,r.kt)("h2",{id:"kubernetes"},"Kubernetes"),(0,r.kt)("p",null,"sfTrace is run as an initContainer in the application pod. User can deploy this either using a manifest yaml or a Helm chart."),(0,r.kt)("h3",{id:"example-of-manifest-yaml"},"Example of Manifest yaml"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/snappyflow/website-artefacts/blob/master/sfTracing/java/java_k8s_standalone_deployment.yaml"},"java_k8s_standalone_deployment.yaml"),"\u202f "),(0,r.kt)("h3",{id:"example-of-a-helm-chart"},"Example of a Helm chart"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Update values.yaml"),": Refer to\u202f",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snappyflow/website-artefacts/blob/master/sfTracing/java/java_k8s_with_helm_chart_values.yaml"},"java_k8s_with_helm_chart_values.yaml"),"\u202f\u202fto configure agent specific properties. Look at sections with ",(0,r.kt)("inlineCode",{parentName:"p"},"SFTRACE-CONFIG")," description "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Update deployment.yam"),"l: Refer to\u202f",(0,r.kt)("a",{parentName:"p",href:"https://github.com/snappyflow/website-artefacts/blob/master/sfTracing/java/java_k8s_with_helm_chart_deployment.yaml"},"java_k8s_with_helm_chart_deployment.yaml"),"\u202f\u202fto copy trace agent to the container and start the container by attaching  the agent. Look at sections with ",(0,r.kt)("inlineCode",{parentName:"p"},"SFTRACE-CONFIG")," description"),(0,r.kt)("h2",{id:"ecs"},"ECS"),(0,r.kt)("h3",{id:"create-the-task-definition"},"Create the Task definition"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Open Amazon ECS, in navigation pane, choose task definition and click on Create New Task Definition and select the launch type as EC2 or Fargate, click on Next step. ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Give the Task definition Name ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Task Role, choose an IAM role that provides permissions for containers in  your task to make calls to AWS APIs on your behalf and Network Mode")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Click on Add containers. Give a Container name, and give the Image of your Java Application. Set Memory limit and port mappings as per your task requirements. In the environment section, for Entry Point give sh , -c For Command paste the following lines "))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir /sfagent && wget -O /sfagent/sftrace-agent.tar.gz\nhttps://github.com/snappyflow/apm-agent/releases/download/latest/sftrace-agent.tar.gz && cd /sfagent && tar -xvzf sftrace-agent.tar.gz && java -javaagent:/sfagent/sftrace/java/sftrace-java-agent.jar -jar <your_jar_name>\n")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Some EC2 task definitions may be running on host containers that don\u2019t recoginise the wget command in such case, add below lines in the above command, apt update && apt -y upgrade.\nAdd the following Environment Variables:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre"},"SFTRACE_PROJECT_NAME <project_name>\nSFTRACE_APP_NAME <app_name>\nSFTRACE_SERVICE_NAME <service_name>\nSFTRACE_PROFILE_KEY <profile_key>\n")),(0,r.kt)("p",{parentName:"div"},"The below environment variables are only applicable for springmvc and optional."),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre"},'ELASTIC_APM_DISABLE_INSTRUMENTATIONS spring-mvc\nELASTIC_APM_USE_PATH_AS_TRANSACTION_NAME "true"\n')))),(0,r.kt)("h3",{id:"create-the-cluster"},"Create the Cluster"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"In the Navigation pane, select Clusters and click on Create Cluster"),(0,r.kt)("li",{parentName:"ul"},"Select the template as per your requirement"),(0,r.kt)("li",{parentName:"ul"},"Give a Cluster name and give instance, networking Configurations IAM role as per your task requirements")),(0,r.kt)("h3",{id:"create-the-service"},"Create the Service"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click on the Cluster Name you created in the step2"),(0,r.kt)("li",{parentName:"ul"},"Click on Create , Select the Launch type matching to your task definition.  Select the Task Definition Name and Version in the Drop down matching to the task definition you created in step 1"),(0,r.kt)("li",{parentName:"ul"},"Give a Service Name and select other requirements as per your task compatibility"),(0,r.kt)("li",{parentName:"ul"},"Click on next step and start your service")))}k.isMDXComponent=!0}}]);